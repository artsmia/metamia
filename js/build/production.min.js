function determineType(a){switch(a){case"!":return"filterno";case"&":return"filter";case"or":return"filteror";case"=":return 0;case">":return 1;case"<":return 2}}function filteroperators(a,b){var c,d=a.parent().children(".filter"),e=a.parent().children(".ornot").attr("alt");if(0!=a.parent().find(".rng").length)var f=!0;else var f=!1;if("flt"==b)var g=!0,h=["!","&","or"];else var g=!1,h=["=",">","<"];var i=h.length;if(a.closest("#inputs").length>0)var j="sidebar";else if(a.closest(".advs-fs").length>0)var j="advanced";var k=jQuery.inArray(a.text(),h)+1;if(k==i&&(k=0),g)if(flttype=determineType(h[k]),f){c=determineType(a.next().text());var l=flttype+"["+e+":op="+c+"][]"}else var l=flttype+"["+e+"][]";else{flttype=determineType(a.prev().text()),c=determineType(h[k]);var l=flttype+"["+e+":op="+c+"][]"}if(d.attr("name",l),a.text(h[k]),"advanced"==j){var m=a.parent().children(".filter").attr("id").replace(/\s+/g,"");jQuery(".advsitm-"+m+" .op-type").text(h[k])}}function updateIds(){var a=0,b="";jQuery("#search-bubbles li").each(function(c,d){var e=jQuery(this).attr("class").split(" ");e.length>1&&(e.splice(0,1),b=e.join(" "));var f="bubble-"+a+" "+b;jQuery(this).removeClass(),jQuery(this).addClass(f),a++})}function updateSearch(){if(""!=searchterms){var a="";return a=0==stringsearch?searchterms.join(" "):searchterms}}function checkStringSearch(){jQuery("#string-search").is(":checked")?(stringsearch=!0,jQuery("#ex-m").css("opacity","1"),jQuery("#ex-m span").css("background","#00CC00")):(stringsearch=!1,jQuery("#string-search").parent("label").css("opacity","0.7"),jQuery("#ex-m span").css("background","#000"))}function setCartActions(a){0==a?(jQuery("#genurl-saved-search").hide(),jQuery("#save-cart").show()):(jQuery("#genurl-saved-search").show(),jQuery("#save-cart").hide()),0==jQuery("#saved-search-results li").length?jQuery("#clear-saved-search").hide():jQuery("#clear-saved-search").show()}function heyAjax(a,b,c){jQuery.ajax({url:"../ctrl/redis-ctrl.php",type:"POST",dataType:"json",data:a,success:b,error:c})}function recallsaves(){jQuery.ajax({url:"../ctrl/get_saved_search.php",cache:!1,type:"POST",data:saves,processData:!1,success:function(a){var b=JSON.parse(a);b=b.hits.hits;var c=[];jQuery.each(b,function(a,b){c.push(b._source)}),finalray=[],jQuery.each(c,function(a,b){var c="<li class='result'><h2>"+b.title+"</h2><a href='#' onclick='rmsearch()'>Remove</a></li>";finalray.push(c)}),jQuery("#main-content").append(finalray)},statusCode:{404:function(){alert("ERROR: This search was not found in the system.")},500:function(){alert("ERROR: Internal system error.")}},error:function(){alert("ERROR: undefined - Could not recall search.")}})}function SelectText(a){var b=document.getElementById(a);if(jQuery.browser.msie){var c=document.body.createTextRange();c.moveToElementText(b),c.select()}else if(jQuery.browser.mozilla||jQuery.browser.opera){var d=window.getSelection(),c=document.createRange();c.selectNodeContents(b),d.removeAllRanges(),d.addRange(c)}else if(jQuery.browser.webkit){var d=window.getSelection();d.setBaseAndExtent(b,0,b,1)}}function getSearch(){data={type:"getSearch",UserId:uid,search_type:"cart",search_id:current_cart},heyAjax(data,addscc,geterr)}function genUrl(a,b){data={type:"genUrl",UserId:uid,url_val:a,url_type:b},heyAjax(data,genscc,adderr)}function getAllSaves(){jQuery("#cart").hide(),jQuery("#saved-carts").show("slide"),jQuery(".saved-carts-nav li").first().trigger("click")}document.createElement("article"),document.createElement("footer"),document.createElement("header"),document.createElement("hgroup"),document.createElement("nav"),document.createElement("aside"),jQuery("#advanced-search input[type='submit']").click(function(a){a.preventDefault(),jQuery("#main-submit").trigger("click")}),jQuery("#advanced-search > fieldset").hide(),jQuery("#adv-resourcespace").addClass("active"),jQuery(".fs-resourcespace").show(),jQuery("#advs-main-nav li").click(function(){var a=jQuery(this).prop("id").substr(4);jQuery("#advs-main-nav li").removeClass("active"),jQuery(this).addClass("active"),jQuery("#advanced-search > fieldset").hide(),jQuery(".fs-"+a).show("blind")}),jQuery("#advs-main-nav li").first().trigger("click"),jQuery("#advanced-search input").focus(function(a){var b=jQuery(this).parents(".advs-fs").css("backgroundColor"),c=jQuery(this).attr("id"),d=jQuery(this).prev().text();""==jQuery(this).val()&&jQuery("#advs-srch-view").append("<span style='color:"+b+"' class='advsitm-"+c.replace(/\s+/g,"")+"'> <span class='op-type'>"+d+"</span> <b>"+c+"</b> = <span class='advs-vw-txt'></span></span>"),jQuery(this).on("keyup",function(a){formattedtitle=c.replace(/\s+/g,""),jQuery(".advsitm-"+formattedtitle+" .advs-vw-txt").html(jQuery(this).val())})}),jQuery("#advanced-search input").focusout(function(a){if(""==jQuery(this).val()){var b=jQuery(this).attr("id");jQuery(".advsitm-"+b.replace(/\s+/g,"")).remove()}}),jQuery("#type-chkbx input").css("display","none"),jQuery(".type").each(function(a,b){jQuery(this).is(":checked")?jQuery(this).parent("label").css("opacity","1"):jQuery(this).parent("label").css("opacity","0.3")}),jQuery(".faux-cbx").click(function(){jQuery(this.children[0]).is(":checked")?jQuery(this).css("opacity","1"):jQuery(this).css("opacity","0.3")}),jQuery("#qa select").change(function(){var a=jQuery(this).val(),b="",c="text";jQuery.inArray(a,fltranges)>=0?(b="<a class='rng' alt='"+a+"'>=</a>",c="number"):jQuery.inArray(a,fltdates)>=0&&(b="<a class='rng' alt='"+a+"'>=</a>",c="date",dp=""),jQuery("#inputs").append("<label for='"+a+"'>"+a+"<br/><input id='value' type='"+c+"' class='filter' name='qaf["+a+"]' /><a class='rm-val' href='#'> [x] </a><br/></label>")}),jQuery("#inputs, .advs-fs").on("click",".ornot",function(a){filteroperators(jQuery(this),"flt")}),jQuery("#inputs, .advs-fs").on("click",".rng",function(a){filteroperators(jQuery(this),"rng")}),jQuery("#inputs").on("click",".rm-val",function(a){a.preventDefault(),jQuery(this).parent("label").remove()}),jQuery(".rslt-key").click(function(a){var b=jQuery(this).text(),c=jQuery(this).attr("alt"),d=c,e=jQuery(this).next().text(),f=b.replace(/ /g,""),g="",h="",i="text";jQuery.inArray(c,fltranges)>=0?(g="<a class='rng'>=</a>",i="number",d+=":op=0"):jQuery.inArray(c,fltdates)>=0&&(g="<a class='rng'>=</a>",i="date",d+=":op=0",h="<script>jQuery('#"+f+"').datepicker({dateFormat:'yy-mm-dd'});</script>"),jQuery("#inputs").append("<label for='"+b+"'>"+b+"<br/><a class='ornot' alt='"+c+"'>&</a>"+g+"<input type='"+i+"' id='"+f+"' class='filter' value='"+e+"' name='filter["+d+"][]'/><a class='rm-val' href='#'> [x] </a>"+h+"</label>")}),jQuery("#refine-search").click(function(a){a.preventDefault(),jQuery("#current-page").val(0),jQuery("#main-search-form").submit()}),jQuery("#flt-clear").click(function(a){a.preventDefault(),jQuery("#inputs").empty(),jQuery("#search-filters input").removeAttr("checked"),jQuery(".faux-cbx").css("opacity",.3)}),jQuery("#selfhelp-center").css({height:"0px"});var tick=0,settick=function(){0==tick?tick=1:1==tick?tick=2:2==tick&&(tick=1)};jQuery("#darrow").click(function(a){a.stopPropagation(),a.preventDefault(),(0==tick||2==tick)&&(jQuery("#selfhelp-center").animate({height:650},{duration:400,easing:"easeOutBounce",complete:settick}),jQuery("#darrow").css({transform:"rotate(-90deg)"})),1==tick&&(jQuery("#selfhelp-center").animate({height:0},{duration:400,easing:"easeOutBounce",complete:settick}),jQuery("#darrow").css({transform:"rotate(90deg)"}))}),jQuery(document).mouseup(function(a){if(1==tick){var b=jQuery("#selfhelp-center");b.is(a.target)||0!==b.has(a.target).length||(jQuery("#selfhelp-center").animate({height:0},{duration:400,easing:"easeOutBounce",complete:settick}),jQuery("#darrow").css({transform:"rotate(90deg)"}))}}),jQuery(".help-text a").click(function(a){a.preventDefault(),jQuery(this).next().toggle("fade")}),jQuery(document).mouseup(function(a){var b=jQuery(".help-text"),c=jQuery(".help-text p");b.is(a.target)||0!==b.has(a.target).length||c.fadeOut()}),jQuery("#reset-form").click(function(){jQuery("#flt-clear,#clear-search").trigger("click"),updateSelectList("_all")}),jQuery("#main-search-form").on("submit",function(a){jQuery("#loading-box").fadeIn("fast"),jQuery.each(jQuery("#result-order select"),function(a,b){jQuery("#main-search-form").append("<input type='hidden' name='"+b.name+"' value='"+b.value+"'/>")}),jQuery.each(jQuery("#search-filters input:checkbox"),function(a,b){jQuery(this).is(":checked")&&jQuery("#main-search-form").append("<input type='hidden' name='"+b.name+"' value='"+b.value+"'>")}),jQuery(".filter").each(function(a,b){if(""==b.value)jQuery(this).parent("label").remove();else{var c=b.value.trim();jQuery("#main-search-form").append("<input type='hidden' name='"+b.name+"' value='"+c+"'/>")}})});var totswidth,btnwidth=75,stringsearch="";totswidth=jQuery("#faux-input").width();var searchterms="";""!=jQuery("#main-search-input").val()?(searchterms=jQuery("#main-search-input").val(),setTimeout(function(){jQuery("#main-search-selector").val(searchterms).trigger("focusout")},100)):(jQuery("#main-search-selector").attr("placeholder","Enter Search Term(s)..."),setTimeout(function(){jQuery("#main-search-selector").trigger("focus")},100)),checkStringSearch(),jQuery(window).resize(function(){totswidth=jQuery("#faux-input").width(),jQuery("#main-search-selector").trigger("focusin").trigger("focusout")}),jQuery("#main-search-selector").focusout(function(){if(checkStringSearch(),searchterms=jQuery("#main-search-selector").val(),0==stringsearch){if(-1!=searchterms.indexOf('"')){var a=searchterms.match(/\"/g).length;if(a>=2){var b=.5*a,c=0;for(i=0;b>i;i++)pos1=searchterms.indexOf('"',c),pos2=searchterms.indexOf('"',pos1+1)+1,phrase=searchterms.substr(pos1,pos2-pos1),newphrase=phrase.split(" ").join("&nbsp;"),searchterms=searchterms.replace(phrase,newphrase),c=pos1+newphrase.length}}searchterms=searchterms.split(/ +/),jQuery.each(searchterms,function(a,b){var c="";if(""!=b){if(0==b.indexOf("!")||1==b.indexOf("!")&&0==b.indexOf('"'))var c="bub-not";if((-1!=b.indexOf("?")||-1!=b.indexOf("*"))&&0!=b.indexOf('"'))var c="bub-wild";b=b.split("&nbsp;").join(" "),searchterms[a]=b,jQuery("#search-bubbles").append("<li class='bubble-"+a+" "+c+"'>"+b+"<a class='remove' title='remove'>x</a></li>")}})}else 1==stringsearch&&""!=searchterms&&jQuery("#search-bubbles").append("<li class='bubble-1'>"+searchterms+"<a class='remove' title='remove'>x</a></li>");bubwidth=jQuery("#search-bubbles").width();var d=Math.floor(totswidth-90-bubwidth);jQuery("#main-search-selector").css("width",d).val(""),jQuery("#main-search-input").val(updateSearch()),""!=jQuery("#main-search-input").val()?jQuery("#main-search-selector").attr("placeholder",""):jQuery("#main-search-selector").attr("placeholder","Enter Search Term(s)..."),jQuery("li").on("click","a.remove",function(){if(0==stringsearch){var a=jQuery(this).parent("li").prop("class").split(" ")[0].substr(7);searchterms.splice(a,1)}else searchterms="",jQuery("#main-search-selector").trigger("focusout");jQuery(this).parent("li").remove(),updateIds(),jQuery("#main-search-input").val(updateSearch()),bubwidth=jQuery("#search-bubbles").width();var b=Math.floor(totswidth-90-bubwidth);jQuery("#main-search-selector").css("width",b)})}),jQuery("#main-search-selector").focusin(function(){var a=Math.floor(totswidth-90);jQuery("#main-search-selector").css("width",a),jQuery("#search-bubbles").empty(),jQuery("#main-search-selector").val(updateSearch())}),jQuery("#main-search-selector").on("keyup",function(){jQuery("#main-search-input").val(jQuery(this).val())}),jQuery(document).keypress(function(a){13==a.keyCode&&(updateSearch(),jQuery("#current-page").val(0),jQuery("#main-search-form").submit())}),jQuery("#clear-search").click(function(a){a.preventDefault(),jQuery("#search-bubbles li").remove(),searchterms="",jQuery("#main-search-selector").trigger("focusout")}),jQuery("#ex-m").click(function(){jQuery("#main-search-selector").trigger("focusin").trigger("focusout")}),jQuery(".paged-text > div").hide(),jQuery(".pt-page-0").show(),jQuery(".pt-nav a").click(function(a){a.preventDefault();var b=jQuery(this).parents(".paged-text").prop("id");jQuery("#"+b+" .pt-nav a").removeClass("active"),jQuery(this).addClass("active");var c=jQuery(this).text();jQuery("#"+b+" .ptp").fadeOut(),jQuery("#"+b+" .pt-page-"+c).fadeIn()});var change;jQuery(".pagination a").click(function(a){a.preventDefault();var b=orig_filters,c=jQuery("#form-search-filters").serializeArray();console.log(b),console.log(c),change=JSON.stringify(b)==JSON.stringify(c)?!1:!0});var currentpage=jQuery("#current-page").val();jQuery("#pg-prev").click(function(a){0!=currentpage&&(0==change?currentpage--:currentpage=0,jQuery("#current-page").val(currentpage)),jQuery("#main-search-form").submit()}),jQuery("#pg-first").click(function(a){currentpage=0,jQuery("#current-page").val(currentpage),jQuery("#main-search-form").submit()}),jQuery(".pg-link-inr").click(function(a){currentpage=0==change?this.id.substr(3):0,jQuery("#current-page").val(currentpage),jQuery("#main-search-form").submit()}),jQuery("#next").click(function(a){0==change?currentpage++:currentpage=0,jQuery("#current-page").val(currentpage),jQuery("#main-search-form").submit()}),jQuery(".last").click(function(a){currentpage=0==change?this.id.substr(3):0,jQuery("#current-page").val(currentpage),jQuery("#main-search-form").submit()}),jQuery("#main-submit").click(function(a){a.preventDefault(),jQuery("#current-page").val(0),jQuery("#main-search-form").submit()});var printPage=function(a){switch(a){case"txt":jQuery(".img-wrap").addClass("print-hide"),window.print(),jQuery(".img-wrap").removeClass("print-hide");break;case"img":jQuery(".full-head, .md-wrap h2, .md-wrap h3").addClass("print-hide"),window.print(),jQuery(".full-head, .md-wrap h2, .md-wrap h3").removeClass("print-hide");break;case"imgtxt":window.print()}};jQuery("body").on("click",".print-img, .print-txt, .print-imgtxt",function(){var a=jQuery(this).prop("class").slice(6);printPage(a)});var pshow=!1;jQuery(".rslt-print").click(function(a){0==pshow?(jQuery(this+" .print-options").stop().show("clip"),jQuery(this).addClass("active"),pshow=!0):1==pshow&&(jQuery(this).removeClass("active"),jQuery(this+" .print-options").stop().hide("clip"),pshow=!1)}),jQuery(document).mouseup(function(a){var b=jQuery(".rslt-print"),c=jQuery(".print-options li a");b.is(a.target)||0!==b.has(a.target).length||c.is(a.target)||1!=pshow||(jQuery(".print-options").hide("clip"),pshow=!1,jQuery(".rslt-print").removeClass("active"))});var ssstatus=!1,saves=[],active_cart_view="Current Cart";addqscc=function(a){"true"==a.error?jQuery(".confirm-save").append(a.msg):(jQuery(".confirm-save").fadeOut("slow",function(){jQuery(".fixed-bg").fadeOut("slow"),jQuery("#ss-subnav").after("<span class='scc-msg'>Successfully Saved</span>"),setTimeout(function(){jQuery("#saved-search-form .scc-msg").hide("fold",function(){jQuery(this).remove()})},3e3),jQuery(".confirm-save").remove(),jQuery(".ss-saved").trigger("click")}),current_cart=0,getSearch())},addqerr=function(a){alert(a)},addscc=function(a){if(1!=a.error){saves=[];var b="";"cart_title"in a&&(b+="<h3>"+a.cart_title+"</h3>"),jQuery.each(a.results,function(c,d){"no results"==a.results?b+="<em>No Assets</em>":(b+="<li id='"+c+"'>"+d+"<a class='ssi-dl'>[x]</a></li>",saves.push(c))}),jQuery("#saved-search-results").empty().append(b),0==ssstatus&&(jQuery("#sb-nav-search").css("display","block").addClass("active").trigger("click"),ssstatus=!0)}else jQuery("#saved-search-results").prepend(a.results);setCartActions(current_cart)},adderr=function(a){jQuery("#saved-search-results").append(a)},geterr=function(a){jQuery("#sb-nav-filter").addClass("active"),ssstatus=!1},genscc=function(a){var b=jQuery("<div class='fixed-bg'><div style='display:none;' class='popup'>Your search can be accessed here:<br/><a id='svs-link' href='"+a.results+"'>"+a.results+"</a><ul id='pop-actions'><li id='svs-copy'>Select</li><li id='svs-mail'>Email</li></ul><button>Sweet Thanks.</button></div></div>").hide().fadeIn("slow");jQuery("body").append(b),jQuery(".popup").show("clip"),jQuery(".popup button").click(function(a){jQuery(this).parent(".popup").fadeOut("300",function(){jQuery(".popup").remove()}),jQuery(".fixed-bg").fadeOut("slow",function(){jQuery(".fixed-bg").remove()})})};var ssscc=function(a){if(0==a.error){var b="";"cart_title"in a&&(b+="<h3>"+a.cart_title+"</h3>"),jQuery.each(a.results,function(a,c){if(jQuery.isNumeric(a))var d="itm-cart",e="C",f="carts",g=c,h=a;else var d="itm-query",e="Q",f="queries",g=a,h=c;var i="<a class='dlt-crt'> [x]</a><a class='shr-crt' id='shr-crt"+h+"'>Share</a>";"itm-cart"==d&&0==a&&(i=""),b+="no results"==c?"<em>No "+f+"</em>":"<li class='"+d+"' id='"+d+a+"'><a id='"+h+"' class='itm-vw'>"+g+"</a>"+i+"<span class='itm-ico'>"+e+"</span></li>"}),b=jQuery(b).hide().fadeIn(),jQuery("#saved-items").empty().append(b)}else alert("error")},sserr=function(a){alert("Failed to Save ")};dcscc=function(a){if(1!=a.error){if("type"in a){var b=a.type+a.results;jQuery("#itm-"+b).hide("explode",function(){jQuery(this).remove()})}else var b=a.results;a.results==current_cart&&(current_cart=0,setCartActions(current_cart),getSearch())}},delscc=function(a){0==a.error&&jQuery("#cart #"+a.results).hide("explode",function(){jQuery(this).remove(),setCartActions(current_cart);var b=jQuery.inArray(a.results,saves);saves.splice(b,1)})},jQuery("body").on("click","#svs-mail",function(a){jQuery(".popup").append("<form><label for='svs-to'>To: <input id='svs-to' type='email' name='svsto'/></label><input id='svs-send' type='submit' value='Send'/><a id='svs-send-cancel'>cancel</a></form>"),jQuery("#svs-to").trigger("focus")}),jQuery("body").on("click","#svs-copy",function(a){a.preventDefault(),SelectText("svs-link")}),jQuery("body").on("click","#svs-send-cancel",function(a){a.preventDefault(),jQuery(".popup form").fadeOut("slow",function(){jQuery(this).remove()})}),jQuery("body").on("click","#svs-send",function(a){a.preventDefault(),jQuery(this).attr("disabled","disabled").css("opacity",.3);var b=jQuery("#svs-link").text(),c=jQuery("#svs-to").val();""==c?(jQuery(this).removeAttr("disabled").css("opacity",1),alert("Please enter an email address.")):jQuery.ajax({url:"http://localhost/ctrl/saved_search_send.php",type:"POST",data:{svsto:c,svslink:b,user:user_name,uid:uid},success:function(a){a=JSON.parse(a),0==a.error?(jQuery(".popup form").append("<br/><span class='scc-msg'>"+a.msg+"</span>"),jQuery("#svs-send-cancel").text("close")):(jQuery(".popup form").append("<br/><span class='error'>"+a.msg+"</span>"),setTimeout(function(){jQuery(".popup form .error").fadeOut("slow",function(){this.remove()})},5e3)),jQuery("#svs-send").removeAttr("disabled").css("opacity",1)},error:function(){alert("error")}})}),jQuery("#saved-carts").on("click",".shr-crt",function(a){a.preventDefault();var b=jQuery(this).prop("id").substr(7),c=jQuery.isNumeric(b)?"cart":"query";genUrl(b,c)}),jQuery(".rslt-sv-query").click(function(){var a=jQuery("<div class='fixed-bg'><div class='confirm-save'><h3>Please name your search.</h3><input type='text' id='svq-title' placeholder='Enter name' /><button id='svq-confirm'>Save</button><button id='svq-cancel'>Cancel</button></div></div>").hide().fadeIn("slow");jQuery("body").append(a)}),jQuery("body").on("click","#svq-confirm",function(){var a=jQuery("#svq-title").val();""==a?(jQuery(".err").remove(),jQuery(".confirm-save h3").after("<span class='err'>No. Really. It needs a name.</span>"),setTimeout(function(){jQuery(".err").fadeOut("slow",function(){jQuery(this).remove()})},4e3)):(data={type:"addQuery",UserId:uid,sUrl:window.location.href,title:a},heyAjax(data,addqscc,addqerr))}),jQuery("body").on("click","#svq-cancel",function(){jQuery(".confirm-save").hide("fold",function(){jQuery(this).remove()}),jQuery(".fixed-bg").fadeOut("slow",function(){jQuery(".fixed-bg").remove()})}),jQuery(".rslt-sv-page").click(function(){jQuery(".save-search").each(function(a,b){jQuery(this).trigger("click")})}),jQuery("#save-cart").click(function(a){if(a.preventDefault(),0!=jQuery("#saved-search-results li").length){var b=jQuery("<div class='fixed-bg'><div class='confirm-save'><h3>Lets give this search a name.</h3><label><input type='text' class='cart-name' placeholder='Name your search.'></label><br/><button id='svcart'>Save</button><button id='svq-cancel'>Cancel</button></div></div>").hide().fadeIn("slow");jQuery("body").append(b)}else alert("There are no Assets in this Set to save.")}),jQuery("body").on("click","#svcart",function(a){var b=jQuery(".cart-name").val();if(""==b)jQuery(".err").remove(),jQuery(".cart-name").css("border","1px solid #F00"),jQuery(".confirm-save h3").after("<span class='err'>No really it needs a name</span>"),setTimeout(function(){jQuery(".err").fadeOut("slow",function(){jQuery(this).remove()})},5e3);else{var c={type:"saveCart",UserId:uid,cart_title:b,cart_id:current_cart};heyAjax(c,addqscc,addqerr)}}),jQuery("#genurl-saved-search").click(function(a){a.preventDefault(),genUrl(current_cart,"cart")}),jQuery("#view-cart").click(function(a){a.preventDefault(),url=base_url+"views/home.php?svsrch="+md5uid+":"+current_cart,window.location.replace(url)}),jQuery(".save-search, .fv-save-search").click(function(a){a.preventDefault();var b=jQuery(this).prop("id");if("Current cart"!=active_cart_view&&jQuery(".ss-current").trigger("click"),-1==jQuery.inArray(b,saves)){saves.push(b);var c=jQuery(this).prop("title"),d={type:"addItem",UserId:uid,cart_id:current_cart,item_id:b,item_title:c};heyAjax(d,addscc,adderr)}else jQuery("#saved-search-results "+b).effect("hightlight")}),jQuery(".ss-saved").click(function(a){a.preventDefault(),getAllSaves()}),jQuery("#saved-items").on("click",".itm-cart .itm-vw",function(){var a=jQuery(this).prop("id");current_cart=a,data={type:"getSearch",UserId:uid,search_type:"cart",search_id:a},heyAjax(data,addscc,adderr),jQuery("#current-cart").val(current_cart),jQuery(".ss-current").trigger("click")}),jQuery("#saved-items").on("click",".itm-query .itm-vw",function(){var a=jQuery(this).prop("id");window.location.replace(base_url+"views/home.php"+a)}),jQuery("#saved-carts").on("click",".dlt-crt",function(){var a=jQuery(this).parents("li").prop("id").substr(8);if(jQuery.isNumeric(a))ctype="cart";else{ctype="query";var a=jQuery(this).parents("li").prop("id").substr(9)}var b=confirm("Are you sure you want to delete this?");b&&(data={type:"deleteCart",UserId:uid,cart_id:a,cart_type:ctype},heyAjax(data,dcscc,sserr))}),jQuery(".saved-carts-nav li").click(function(){jQuery(".saved-carts-nav li").removeClass("active"),jQuery(this).addClass("active");var a=jQuery(this).text().toLowerCase();data={type:"getSearch",UserId:uid,search_type:a,search_id:""},heyAjax(data,ssscc,sserr)}),jQuery("#saved-search-form").on("click",".ssi-dl",function(a){a.preventDefault();var b=jQuery(this).parents("li").prop("id"),c={type:"removeItem",UserId:uid,cart_id:current_cart,item_id:b};heyAjax(c,delscc,adderr)}),jQuery("#clear-saved-search").click(function(a){a.preventDefault();var b=confirm("Are you sure you want to delete this cart?");if(b){var c={type:"deleteCart",UserId:uid,cart_id:current_cart,cart_type:"cart"};heyAjax(c,dcscc,adderr)}}),jQuery(".sb-nav a").click(function(a){a.preventDefault();var b=jQuery(this).prop("id").substr(7);setActiveSidebar(b)}),setActiveSidebar=function(a){"search"==a?(ssstatus=!0,getSearch()):"filter"==a&&(ssstatus=!1),jQuery("#sb-view").val(a.slice(0,1)),jQuery(".sb-nav a").removeClass("active"),jQuery("#sb-nav-"+a).addClass("active"),jQuery(".sidebar form").hide("fade"),jQuery(".sb-form-"+a).show("drop")},setActiveSidebar(sb),jQuery(".ss-current").click(function(a){a.preventDefault(),jQuery("#cart").show("clip"),jQuery("#saved-carts").hide("clip")}),jQuery("#ss-subnav li a").click(function(){jQuery("#ss-subnav li a").removeClass("active"),jQuery(this).addClass("active"),active_cart_view=jQuery(this).text()}),setCartActions(current_cart),jQuery("#loading-box").css("display","block"),jQuery("#loading-box").fadeOut(),jQuery("header").css("top",-100),jQuery("header").animate({top:0},500),jQuery(".more-data").css("display","none"),jQuery("#welcome").fadeIn("slow"),jQuery("#welcome h2 span").hide(),jQuery(document).ready(function(){var a=0;jQuery("#welcome h2 span").each(function(b,c){setTimeout(function(){jQuery(c).fadeIn("slow")},150*a),a++})});var state="open";jQuery("#sh-sidebar").click(function(a){a.preventDefault(),"open"==state?(jQuery(".sidebar").animate({right:"-20%"},500),jQuery("#sh-sidebar").html("&#10096; Filters"),jQuery(".more-data").animate({width:"94%"}),jQuery("#results-dashboard").animate({width:"92%","padding-right":"5%"},500),jQuery("#results").animate({width:"96%"},500),jQuery("footer").animate({width:"100%"}),state="closed",setTimeout(function(){$container.masonry()},300)):"closed"==state&&(jQuery(".sidebar").animate({right:0},500),jQuery(".more-data").animate({width:"74%"}),jQuery("#sh-sidebar").animate({right:0},500).html("Hide &#10097;"),jQuery("#results").animate({width:"77%"},500),jQuery("#results-dashboard").animate({width:"76%"},500),jQuery("footer").animate({width:"80%"},600),state="open",setTimeout(function(){$container.masonry()},300))}),jQuery("#result-order select").on("change",function(){jQuery("#main-search-form").submit()});for(var imgs=document.getElementsByTagName("img"),i=0,j=imgs.length;j>i;i++)imgs[i].onload=function(a){$container.masonry("layout")},imgs[i].onerror=function(a){this.parentNode.remove(this),$container.masonry("layout")};var $container=$("#results");if($container.masonry({itemSelector:".result",columnWidth:".grid-sizer",percentPosition:!0}),showResults=function(){$container.masonry()},jQuery("#list-view").click(function(a){a.preventDefault(),0==jQuery(this).hasClass("active")&&viewList()}),jQuery("#mid-view").click(function(a){0==jQuery(this).hasClass("active")&&viewListThumb()}),jQuery("#thum-view").click(function(a){a.preventDefault(),0==jQuery(this).hasClass("active")&&viewThumb()}),viewList=function(){jQuery("#view-selector a").removeClass("active"),jQuery("#list-view").addClass("active"),jQuery(".result").css("width","98%"),jQuery(".thumb-actions").css({position:"absolute",right:"5px",bottom:"7px"}),jQuery(".thumbnail, .result p, .result video, .result audio").css("display","none"),jQuery(".result > a, .result > h2, .result > h3").css({display:"inline-block","margin-right":"10px","vertical-align":"middle"}),jQuery(".result > a").css("float","right"),jQuery("#view-type").val("list"),showResults()},viewListThumb=function(){jQuery("#view-selector a").removeClass("active"),jQuery("#mid-view").addClass("active"),jQuery(".result").css("width","98%"),jQuery(".thumb-actions").css({position:"absolute",right:"5px",bottom:"7px"}),jQuery(".thumbnail").css({display:"block","max-width":"20%","float":"left","margin-right":"10px"}),jQuery(".result > p").css({display:"block"}),jQuery(".result video, .result audio").css({display:"block","float":"left","margin-right":"10px"}),jQuery("#view-type").val("mid"),showResults()},viewThumb=function(){jQuery("#view-selector a").removeClass("active"),jQuery("#thum-view").addClass("active"),jQuery(".result").css("width","30%"),jQuery(".thumb-actions").css({position:"relative",right:"0",bottom:"-5px"}),jQuery(".thumbnail, .result p").css({display:"block","float":"none","max-width":"100%",margin:"0"}),jQuery(".result > a, .result > h2, .result > h3").css({display:"block","margin-right":"0"}),jQuery(".result > a").css("float","none"),jQuery(".result video, .result audio").css({display:"block","max-width":"100%"}),jQuery("#view-type").val("thum"),showResults()},jQuery(".thumb-loader").css("display","none"),jQuery(".result img").fadeIn("slow").css("display","block"),"home"==pagename){var isfixed=!1;jQuery(window).scroll(function(){var a=jQuery(window).scrollTop();a>100&&0==isfixed?(isfixed=!0,jQuery("#results-dashboard").addClass("rs-dsh-fxd"),jQuery("#main-content").css("padding-top","115px")):100>a&&1==isfixed&&(isfixed=!1,jQuery("#results-dashboard").removeClass("rs-dsh-fxd"),jQuery("#main-content").css("padding-top",0))})}jQuery(window).load(function(){var a=$("#results");a.masonry("layout")});var updateSelectList=function(a,b){jQuery("#faux-select-input").val();if(console.log(b),console.log(a),"_all"!=a){var c=b[a].color,d=b[a].title;-1!=idxval.indexOf("_all")&&(idxval.splice(idxval.indexOf("_all"),1),idxdisplay.splice(idxval.indexOf("_all"),1)),-1==idxval.indexOf(a)?(idxval.push(a),idxdisplay.push("<span class='idx' style='background:"+c+"'>"+d+"</span>")):(idxdisplay.splice(idxval.indexOf(a),1),idxval.splice(idxval.indexOf(a),1))}else idxval=["_all"],idxdisplay=["<span class='idx'>All</span>"];(0==idxval.length||4==idxval.length)&&(idxval=["_all"],idxdisplay=["<span class='idx'>All</span>"]);var e=100/idxval.length+"%";jQuery("#faux-select-selector span").empty().html(idxdisplay),jQuery(".idx").css("width",e),jQuery("#faux-select-input").val(idxval)};idxval=[],idxdisplay=[],""==loadval&&(loadval="_all"),loadval=loadval.split(","),jQuery.each(loadval,function(a,b){updateSelectList(b,indices)}),jQuery("#faux-select-input").val(loadval);var isopen=!1;jQuery("#faux-select-selector").click(function(a){a.preventDefault(),0==isopen?(jQuery("#faux-select-list").show("blind"),isopen=!0):(jQuery("#faux-select-list").hide("blind"),isopen=!1)}),jQuery(document).mouseup(function(a){var b=jQuery("#faux-select"),c=jQuery("#faux-select-list");b.is(a.target)||0!==b.has(a.target).length||(c.hide(),isopen=!1)}),jQuery("#faux-select li").click(function(a){updateSelectList(jQuery(this).prop("id").substr(3),indices),isopen=!1}),$(function(){var a={"":$("#results")};$(window).bind("hashchange",function(b){var c=$.param.fragment();$("a.fv-current").removeClass("fv-current"),$(".more-data").fadeOut(2e3),$(".result").show();var d=$("#results");d.masonry(),c&&$('a[href="#'+c+'"]').addClass("fv-current"),a[c]?jQuery("#"+c).fadeIn("fast"):a[c]=$('<div class="more-data-sv"/>').appendTo("#results").load(c,function(){$("#loading-box").fadeOut(),jQuery("#"+c).fadeIn("slow")})}),$(window).trigger("hashchange")});
